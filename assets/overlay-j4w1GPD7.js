import{b as f,_ as P}from"./tslib.es6-ChmHIYM0.js";import{c as h}from"./index-DtBkkNk_.js";import{r as u}from"./index-BBkUAzwr.js";import{r as k}from"./index-PqR-_bA4.js";import{P as L,D as N,e as S,O as g,f as A,g as F,h as C,j as T,k as v,l as x,m as R,A as w}from"./buttons-CKwIiXPX.js";import{C as E,T as B}from"./TransitionGroup-BEjLb10U.js";function j(s,n){return s===n||s.contains(n)}function b(s,n){var e;if(s==null)return document.activeElement;var t=(e=s.getRootNode(n))!==null&&e!==void 0?e:document;return t.activeElement}function q(s){return function(n){return s.some(function(e){return n.key===e})&&n.target.dispatchEvent(new MouseEvent("click",f(f({},n),{view:void 0})))}}function I(s){return typeof s=="function"}var K={blueprintPortalClassName:function(s,n){if(s[n]!=null&&typeof s[n]!="string")return new Error(S)}},M=function(s){P(n,s);function n(){var e=s!==null&&s.apply(this,arguments)||this;return e.context={},e.state={hasMounted:!1},e.portalElement=null,e}return n.prototype.render=function(){return typeof document>"u"||!this.state.hasMounted||this.portalElement===null?null:k.createPortal(this.props.children,this.portalElement)},n.prototype.componentDidMount=function(){this.props.container!=null&&(this.portalElement=this.createContainerElement(),this.props.container.appendChild(this.portalElement),this.addStopPropagationListeners(this.props.stopPropagationEvents),this.setState({hasMounted:!0},this.props.onChildrenMount))},n.prototype.componentDidUpdate=function(e){this.portalElement!=null&&e.className!==this.props.className&&(W(this.portalElement.classList,e.className),y(this.portalElement.classList,this.props.className)),this.portalElement!=null&&e.stopPropagationEvents!==this.props.stopPropagationEvents&&(this.removeStopPropagationListeners(e.stopPropagationEvents),this.addStopPropagationListeners(this.props.stopPropagationEvents))},n.prototype.componentWillUnmount=function(){var e;this.removeStopPropagationListeners(this.props.stopPropagationEvents),(e=this.portalElement)===null||e===void 0||e.remove()},n.prototype.createContainerElement=function(){var e=document.createElement("div");return e.classList.add(L),y(e.classList,this.props.className),this.context!=null&&y(e.classList,this.context.blueprintPortalClassName),e},n.prototype.addStopPropagationListeners=function(e){var t=this;e==null||e.forEach(function(o){var r;return(r=t.portalElement)===null||r===void 0?void 0:r.addEventListener(o,_)})},n.prototype.removeStopPropagationListeners=function(e){var t=this;e==null||e.forEach(function(o){var r;return(r=t.portalElement)===null||r===void 0?void 0:r.removeEventListener(o,_)})},n.displayName="".concat(N,".Portal"),n.contextTypes=K,n.defaultProps={container:typeof document<"u"?document.body:void 0},n}(u.Component);function W(s,n){n!=null&&n!==""&&s.remove.apply(s,n.split(" "))}function y(s,n){n!=null&&n!==""&&s.add.apply(s,n.split(" "))}function _(s){s.stopPropagation()}var z=function(s){P(n,s);function n(){var e=s!==null&&s.apply(this,arguments)||this;return e.isAutoFocusing=!1,e.state={hasEverOpened:e.props.isOpen},e.containerElement=null,e.startFocusTrapElement=null,e.endFocusTrapElement=null,e.refHandlers={container:function(t){return e.containerElement=k.findDOMNode(t)},endFocusTrap:function(t){return e.endFocusTrapElement=t},startFocusTrap:function(t){return e.startFocusTrapElement=t}},e.maybeRenderChild=function(t){if(I(t)&&(t=t()),t==null)return null;var o=typeof t=="object"?u.cloneElement(t,{className:h(t.props.className,g)}):u.createElement("span",{className:g},t),r=e.props,a=r.onOpening,i=r.onOpened,l=r.onClosing,c=r.transitionDuration,p=r.transitionName;return u.createElement(E,{classNames:p,onEntering:a,onEntered:i,onExiting:l,onExited:e.handleTransitionExited,timeout:c,addEndListener:e.handleTransitionAddEnd},o)},e.handleStartFocusTrapElementFocus=function(t){var o;!e.props.enforceFocus||e.isAutoFocusing||t.relatedTarget!=null&&e.containerElement.contains(t.relatedTarget)&&t.relatedTarget!==e.endFocusTrapElement&&((o=e.endFocusTrapElement)===null||o===void 0||o.focus({preventScroll:!0}))},e.handleStartFocusTrapElementKeyDown=function(t){var o;if(e.props.enforceFocus&&t.shiftKey&&t.which===A){var r=e.getKeyboardFocusableElements().pop();r!=null?r.focus():(o=e.endFocusTrapElement)===null||o===void 0||o.focus({preventScroll:!0})}},e.handleEndFocusTrapElementFocus=function(t){var o,r;if(t.relatedTarget!=null&&e.containerElement.contains(t.relatedTarget)&&t.relatedTarget!==e.startFocusTrapElement){var a=e.getKeyboardFocusableElements().shift();!e.isAutoFocusing&&a!=null&&a!==t.relatedTarget?a.focus():(o=e.startFocusTrapElement)===null||o===void 0||o.focus({preventScroll:!0})}else{var i=e.getKeyboardFocusableElements().pop();i!=null?i.focus():(r=e.startFocusTrapElement)===null||r===void 0||r.focus({preventScroll:!0})}},e.handleTransitionExited=function(t){var o,r;e.props.shouldReturnFocusOnClose&&e.lastActiveElementBeforeOpened instanceof HTMLElement&&e.lastActiveElementBeforeOpened.focus(),(r=(o=e.props).onClosed)===null||r===void 0||r.call(o,t)},e.handleBackdropMouseDown=function(t){var o,r=e.props,a=r.backdropProps,i=r.canOutsideClickClose,l=r.enforceFocus,c=r.onClose;i&&(c==null||c(t)),l&&e.bringFocusInsideOverlay(),(o=a==null?void 0:a.onMouseDown)===null||o===void 0||o.call(a,t)},e.handleDocumentClick=function(t){var o=e.props,r=o.canOutsideClickClose,a=o.isOpen,i=o.onClose,l=t.composed?t.composedPath()[0]:t.target,c=n.openStack.indexOf(e),p=n.openStack.slice(c).some(function(d){var m=d.containerElement;return m&&m.contains(l)&&!m.isSameNode(l)});a&&!p&&r&&(i==null||i(t))},e.handleDocumentFocus=function(t){var o=t.composed?t.composedPath()[0]:t.target;e.props.enforceFocus&&e.containerElement!=null&&o instanceof Node&&!e.containerElement.contains(o)&&(t.preventDefault(),t.stopImmediatePropagation(),e.bringFocusInsideOverlay())},e.handleKeyDown=function(t){var o=e.props,r=o.canEscapeKeyClose,a=o.onClose;t.key==="Escape"&&r&&(a==null||a(t),t.stopPropagation(),t.preventDefault())},e.handleTransitionAddEnd=function(){},e}return n.getDerivedStateFromProps=function(e){var t=e.isOpen;return t?{hasEverOpened:t}:null},n.prototype.render=function(){var e,t;if(this.props.lazy&&!this.state.hasEverOpened)return null;var o=this.props,r=o.autoFocus,a=o.children,i=o.className,l=o.enforceFocus,c=o.usePortal,p=o.isOpen,d=p?(t=u.Children.map(a,this.maybeRenderChild))!==null&&t!==void 0?t:[]:[],m=this.maybeRenderBackdrop();m!==null&&d.unshift(m),p&&(r||l)&&d.length>0&&(d.unshift(this.renderDummyElement("__start",{className:F,onFocus:this.handleStartFocusTrapElementFocus,onKeyDown:this.handleStartFocusTrapElementKeyDown,ref:this.refHandlers.startFocusTrap})),l&&d.push(this.renderDummyElement("__end",{className:C,onFocus:this.handleEndFocusTrapElementFocus,ref:this.refHandlers.endFocusTrap})));var D=h(T,(e={},e[v]=p,e[x]=!c,e),i),O=u.createElement(B,{appear:!0,"aria-live":"polite",className:D,component:"div",onKeyDown:this.handleKeyDown,ref:this.refHandlers.container},d);return c?u.createElement(M,{className:this.props.portalClassName,container:this.props.portalContainer,stopPropagationEvents:this.props.portalStopPropagationEvents},O):O},n.prototype.componentDidMount=function(){this.props.isOpen&&this.overlayWillOpen()},n.prototype.componentDidUpdate=function(e){e.isOpen&&!this.props.isOpen?this.overlayWillClose():!e.isOpen&&this.props.isOpen&&this.overlayWillOpen()},n.prototype.componentWillUnmount=function(){this.overlayWillClose()},n.prototype.bringFocusInsideOverlay=function(){var e=this;return this.requestAnimationFrame(function(){var t,o=b(e.containerElement);if(!(e.containerElement==null||o==null||!e.props.isOpen)){var r=!e.containerElement.contains(o);r&&((t=e.startFocusTrapElement)===null||t===void 0||t.focus({preventScroll:!0}),e.isAutoFocusing=!1)}})},n.prototype.maybeRenderBackdrop=function(){var e=this.props,t=e.backdropClassName,o=e.backdropProps,r=e.hasBackdrop,a=e.isOpen,i=e.transitionDuration,l=e.transitionName;return r&&a?u.createElement(E,{classNames:l,key:"__backdrop",timeout:i,addEndListener:this.handleTransitionAddEnd},u.createElement("div",f({},o,{className:h(R,t,o==null?void 0:o.className),onMouseDown:this.handleBackdropMouseDown}))):null},n.prototype.renderDummyElement=function(e,t){var o=this.props,r=o.transitionDuration,a=o.transitionName;return u.createElement(E,{classNames:a,key:e,addEndListener:this.handleTransitionAddEnd,timeout:r,unmountOnExit:!0},u.createElement("div",f({tabIndex:0},t)))},n.prototype.getKeyboardFocusableElements=function(){var e=this.containerElement!==null?Array.from(this.containerElement.querySelectorAll(['a[href]:not([tabindex="-1"])','button:not([disabled]):not([tabindex="-1"])','details:not([tabindex="-1"])','input:not([disabled]):not([tabindex="-1"])','select:not([disabled]):not([tabindex="-1"])','textarea:not([disabled]):not([tabindex="-1"])','[tabindex]:not([tabindex="-1"])'].join(","))):[];return e.filter(function(t){return!t.classList.contains(F)&&!t.classList.contains(C)})},n.prototype.overlayWillClose=function(){document.removeEventListener("focus",this.handleDocumentFocus,!0),document.removeEventListener("mousedown",this.handleDocumentClick);var e=n.openStack,t=e.indexOf(this);if(t!==-1){if(e.splice(t,1),e.length>0){var o=n.getLastOpened();o.props.autoFocus&&o.props.enforceFocus&&(o.bringFocusInsideOverlay(),document.addEventListener("focus",o.handleDocumentFocus,!0))}e.filter(function(r){return r.props.usePortal&&r.props.hasBackdrop}).length===0&&document.body.classList.remove(v)}},n.prototype.overlayWillOpen=function(){var e=n.getLastOpened,t=n.openStack;t.length>0&&document.removeEventListener("focus",e().handleDocumentFocus,!0),t.push(this),this.props.autoFocus&&(this.isAutoFocusing=!0,this.bringFocusInsideOverlay()),this.props.enforceFocus&&document.addEventListener("focus",this.handleDocumentFocus,!0),this.props.canOutsideClickClose&&!this.props.hasBackdrop&&document.addEventListener("mousedown",this.handleDocumentClick),this.props.hasBackdrop&&this.props.usePortal&&document.body.classList.add(v),this.lastActiveElementBeforeOpened=b(this.containerElement)},n.displayName="".concat(N,".Overlay"),n.defaultProps={autoFocus:!0,backdropProps:{},canEscapeKeyClose:!0,canOutsideClickClose:!0,enforceFocus:!0,hasBackdrop:!0,isOpen:!1,lazy:!0,shouldReturnFocusOnClose:!0,transitionDuration:300,transitionName:T,usePortal:!0},n.openStack=[],n.getLastOpened=function(){return n.openStack[n.openStack.length-1]},n}(w);export{z as O,q as c,j as e,I as i};
